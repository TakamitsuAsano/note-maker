import streamlit as st

# --- ページ設定 ---
st.set_page_config(
    page_title="菊池優太のSpace Note Maker",
    page_icon="🚀",
    layout="wide"
)

# --- データの定義（リーダーシップ理論とカテゴリ） ---
leadership_theories = {
    "1. イノベーション・変革・起業": {
        "イノベーターのDNA": "破壊的イノベーターに共通する5つのスキル（関連づける、質問する、観察する、ネットワーク、実験する）。",
        "シリアル・イノベーター": "組織内の政治的な壁を乗り越え、何度もイノベーションを成功させる技術力と政治力を持つ人材。",
        "両利きのリーダーシップ": "既存事業の深掘り（知の深化）と、新規事業の探索（知の探索）を同時にマネジメントする。",
        "エフェクチュエーション": "目的から逆算せず、手持ちの手段（鳥）から何ができるかを考え、不確実性をコントロールする。",
        "イントラプレナーシップ": "社内起業家精神。組織に属しながらリスクを取り、自律的に新規事業を推進する。",
        "変革型リーダーシップ": "ビジョンを掲げ、メンバーの意識や価値観を根本から変革し、期待以上の成果を引き出す。",
        "アダプティブ・リーダーシップ": "適応を要する課題に対し、組織の痛みを伴う変化（学習や価値観の転換）を促す。",
        "ブルー・オーシャン・リーダーシップ": "管理職の「やめるべき業務」を捨て、「付加価値の高い業務」へ時間をシフトさせる。"
    },
    "2. 組織・チーム・人間関係重視": {
        "サーバント・リーダーシップ": "リーダーはまず奉仕者であれ。メンバーの強みを活かし、目標達成を支援する。",
        "オーセンティック・リーダーシップ": "自分らしさ（真正性）を重視。倫理観や価値観に正直であり、信頼を得る。",
        "レベル5・リーダーシップ": "「個人的な謙虚さ」と「職業人としての不屈の意志」を兼ね備える。",
        "EQリーダーシップ": "EQ（心の知能指数）を重視し、自分と他者の感情を理解・管理してチームを動かす。",
        "インクルーシブ・リーダーシップ": "多様性を尊重し、すべてのメンバーが受け入れられていると感じさせる。",
        "シェアード・リーダーシップ": "特定の1人ではなく、全員が状況に応じてリーダーシップを分担・発揮する。"
    },
    "3. 古典的・学術的": {
        "PM理論": "目標達成機能（P）と集団維持機能（M）の2軸で捉える。",
        "状況対応理論 (SL理論)": "部下の成熟度に合わせて、指示・説得・参加・委任とスタイルを変える。",
        "条件適合理論": "リーダーの資質と状況の相性で成果が決まるとする。",
        "マネジリアル・グリッド": "業績への関心と人間への関心の2軸で分類。",
        "特性理論": "リーダーシップは生まれ持った才能であるとする古典的考え。"
    },
    "4. 新しい組織形態": {
        "アジャイル・リーダーシップ": "権限委譲を進め、自律的なチームが迅速に動ける環境を整備する庭師のような役割。",
        "ティール組織のリーダーシップ": "ヒエラルキーを手放し、組織を生命体と捉え、自主経営を見守る。",
        "ホラクラシー": "役職ではなく役割（ロール）に基づいて組織を運営する権限分散型。"
    }
}

# 状況別のおすすめマッピング
recommendations = {
    "0→1の新規事業フェーズ": ["エフェクチュエーション", "イノベーターのDNA", "イントラプレナーシップ"],
    "組織の拡大期・混乱期": ["サーバント・リーダーシップ", "心理的安全性(インクルーシブ)", "アダプティブ・リーダーシップ"],
    "既存事業と新規事業の対立": ["両利きのリーダーシップ", "シリアル・イノベーター", "変革型リーダーシップ"],
    "成熟した組織の変革": ["ブルー・オーシャン・リーダーシップ", "ティール組織のリーダーシップ"]
}

# --- UI構築 ---

st.title("🚀 Space Note Maker for Yuta Kikuchi")
st.markdown("""
このアプリは、菊池優太の週次Note記事作成を支援します。  
入力された「今週の面白い情報」を、選択された「リーダーシップ理論」のレンズを通して、
**「山口周的な哲学的洞察」×「宇宙ビジネスへの熱い想い」** を込めた記事にするためのプロンプトを生成します。
""")

st.divider()

col1, col2 = st.columns([1, 1])

with col1:
    st.subheader("1. ネタの入力")
    st.info("今週、一番面白いと感じた情報（ニュース、Webサイト、地域の企業の取り組みなど）をナラティブに入力してください。整理されていなくてOKです。")
    narrative_input = st.text_area("インプット情報（Source Material）", height=300, placeholder="例：今日、地元の金型工場の社長と話したんだけど、彼らの技術への執着がすごかった。一見宇宙とは関係なさそうだけど、この泥臭さこそが...（URLや記事のコピペでも可）")

with col2:
    st.subheader("2. 視点の選択")
    
    # 状況から選ぶフィルター機能
    filter_option = st.selectbox("今の状況・フェーズは？（おすすめを表示します）", ["指定なし"] + list(recommendations.keys()))
    
    recommended_theories = []
    if filter_option != "指定なし":
        recommended_theories = recommendations[filter_option]
        st.success(f"おすすめ: {', '.join(recommended_theories)}")

    # カテゴリ選択
    category = st.selectbox("リーダーシップのカテゴリ", list(leadership_theories.keys()))
    
    # 理論選択
    theory_name = st.selectbox("適用するリーダーシップ/イノベーション理論", list(leadership_theories[category].keys()))
    
    # 理論の説明表示
    theory_desc = leadership_theories[category][theory_name]
    st.caption(f"**{theory_name}**: {theory_desc}")

st.divider()

# --- プロンプト生成ロジック ---

if st.button("Generate Gemini Prompt (プロンプト生成)"):
    if not narrative_input:
        st.error("インプット情報を入力してください。")
    else:
        # プロンプトのテンプレート
        prompt_text = f"""
あなたはプロの編集者であり、宇宙ビジネスの伝道師である「菊池優太」のゴーストライターです。
以下の【インプット情報】と【適用するレンズ】を用いて、Note記事の構成案と本文ドラフトを作成してください。

# 1. 制約条件（重要）
* **著者のペルソナ:** 菊池優太
    * 宇宙関連ビジネスの人材流動性を高めることに情熱を注いでいる。
    * **トンマナ:** 前向き、未来志向、哲学的。
    * **思考の型（山口周モデル）:** 「サイエンス（分析）」よりも「アート（直感・美意識）」を重視する。「役に立つ」よりも「意味がある」を問う。
    * **NG事項:** 「私のコンサルタントとしての経験では」「過去のプロジェクトで」といった、**菊池自身が経験していないエビデンスに基づく記述は禁止**。あくまで「教養としての知識」「哲学的な考察」「未来への示唆」として語ること。
* **ターゲット読者:**
    * 既存の古い体質の企業（JTC等）で、承認欲求が満たされず燻っている優秀な人材。
    * 「今の場所では目立てないが、宇宙産業や未来志向の地域企業なら自分が輝けるかもしれない」と感じている人。
* **宇宙ビジネスの定義:**
    * ロケットや衛星だけではない。衣食住、エンタメ、地方創生を含む、地球上の課題解決とリンクした「未来の生活圏」を作るすべての産業。

# 2. 記事のテーマと構造
* **インプット情報（ネタ）:**
{narrative_input}

* **適用するレンズ（リーダーシップ/イノベーション理論）:**
    * **理論名:** {theory_name}
    * **理論の概要:** {theory_desc}

# 3. 執筆指示
以下の流れで記事を構成してください。

1.  **導入 (Hook):**
    * インプット情報の紹介。菊池優太がなぜそれに心を動かされたのか、ナラティブに語る。
    * 一見、宇宙と関係ない話題であっても、強引にでも「宇宙ビジネスの本質」や「未来の働き方」に接続する。
2.  **理論の展開 (Bridge):**
    * ここで「{theory_name}」の概念を持ち出す。「この事象は、まさに経営学で言うところの〇〇だ」と知的権威（山口周的アプローチ）を借りて解説する。
    * ただし、教科書的な解説ではなく、あくまで「今の閉塞感を打破する鍵」として紹介する。
3.  **読者へのメッセージ (Call to Action):**
    * ターゲット読者（燻っている人材）に向けて、「この理論のようなリーダーシップ/行動が、今の宇宙産業（や未来志向の企業）では求められている」と鼓舞する。
    * 「君のその違和感は正しい」「場所を変えれば、その資質は武器になる」という承認とエンパワーメントを与える。

# 4. 出力形式
* タイトル案（キャッチーで山口周風に。「〇〇はなぜ××なのか」など）
* 記事本文（構成案ではなく、そのまま使えるレベルのドラフト）
"""
        
        st.subheader("生成されたプロンプト")
        st.write("以下のテキストをコピーして、Gemini (Google AI Studio / ChatGPT等) に貼り付けてください。")
        st.code(prompt_text, language="text")
        
        st.success("プロンプトを作成しました！右上のコピーボタンでコピーできます。")

# --- アプリのフッター ---
st.markdown("---")
st.caption("Powered by Streamlit | Designed for Space Business Narrative Creation")